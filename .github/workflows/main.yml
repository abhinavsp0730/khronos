on:
    push:
        branches:
            - main

jobs:
    contrib-readme-job:
        runs-on: ubuntu-latest
        name: A job to automate contrib in readme
        steps:
            - name: Contribute List
              uses: akhilmhdh/contributors-readme-action@v2.3.6
              env:
                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    build-project:
        runs-on: ubuntu-latest
        name: Release package to PyPi
        steps:
            - uses: actions/checkout@v4
            - name: Set up Python
              uses: actions/setup-python@v4
              with:
                  python-version: "3.10.8"
            - name: Install pypa/build
              run: pip install build --user
            - name: Build a binary wheel and a source tarball
              run: python3 -m build Khronos
            - name: Store the distribution packages
              uses: actions/upload-artifact@v3
              with:
                name: python-package-distributions
                path: dist/
    publish-to-pypi:
        name: Publish Khronos to PyPi
        needs:
            - build-project
        runs-on: ubuntu-latest
        environment:
            name: pypi
            url: https://pypi.org/p/Khronos-Py  
        permissions:
            id-token: write  
        steps:
          - name: Download all the dists
            uses: actions/download-artifact@v3
            with:
                name: python-package-distributions
                path: dist/
          - name: Publish distribution ðŸ“¦ to PyPI
            uses: pypa/gh-action-pypi-publish@release/v1

